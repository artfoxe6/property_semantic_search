<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>æˆ¿äº§æœç´¢</title>

    <!-- å¼•å…¥ Google Fontsï¼šä¸­æ–‡æ”¯æŒ & ç°ä»£å­—ä½“ -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&family=Roboto:wght@400;500&display=swap"
          rel="stylesheet">

    <!-- å¼•å…¥ Font Awesome å°å›¾æ ‡ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Vue 3 CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <style>
        body {
          font-family: 'Noto Sans SC', 'Roboto', sans-serif;
          background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
          margin: 0;
          padding: 0;
          min-height: 100vh;
          display: flex;
          justify-content: center;
          align-items: flex-start;
          padding-top: 10px;
          color: #333;
        }

        .container {
          width: 50vw;
          max-width: 1400px;
          min-width: 800px;
          padding: 50px;
          background: #ffffff;
          border-radius: 20px;
          box-shadow: 0 12px 36px rgba(0, 82, 204, 0.15);
          border: 1px solid #e0e8f3;
        }

        h1 {
          text-align: center;
          font-size: 38px;
          font-weight: 700;
          color: #0d47a1;
          margin-bottom: 35px;
          letter-spacing: 0.5px;
          text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .search-box {
          width: 100%;
          padding: 22px;
          font-size: 20px;
          font-weight: 500;
          color: #2c3e50;
          border: 2px solid #0d6efd;
          border-radius: 16px;
          outline: none;
          box-sizing: border-box;
          margin-bottom: 40px;
          background-color: #f0f7ff;
          transition: all 0.3s ease;
          box-shadow: 0 4px 12px rgba(13, 110, 253, 0.1);
        }

        .search-box:focus {
          border-color: #0b5ed7;
          box-shadow: 0 6px 20px rgba(13, 110, 253, 0.25);
          transform: scale(1.01);
        }

        .results-grid {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 28px;
        }

        @media (max-width: 1024px) {
          .container {
            width: 85vw;
            padding: 35px;
          }
          h1 {
            font-size: 34px;
          }
        }

        @media (max-width: 768px) {
          .container {
            width: 95vw;
            padding: 25px;
          }
          .results-grid {
            grid-template-columns: 1fr;
          }
          h1 {
            font-size: 28px;
          }
        }

        .house-card {
          padding: 30px;
          border-radius: 16px;
          background: linear-gradient(to bottom, #ffffff, #fcfdff);
          border: 1px solid #dde5f0;
          box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
          transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
          position: relative;
          overflow: hidden;
        }

        .house-card::before {
          content: '';
          position: absolute;
          top: 0; left: 0;
          width: 4px; height: 100%;
          background: linear-gradient(to bottom, #0d6efd, #0d9ffb);
          border-radius: 4px 0 0 4px;
        }

        .house-card:hover {
          transform: translateY(-6px);
          box-shadow: 0 14px 30px rgba(0, 0, 0, 0.15);
          border-color: #b8daff;
        }

        .address {
          font-size: 20px;
          font-weight: 600;
          color: #1a3a6e;
          margin-bottom: 12px;
        }

        .price {
          font-size: 22px;
          font-weight: bold;
          color: #d32f2f;
          margin-bottom: 14px;
        }

        .info {
          font-size: 15px;
          color: #444;
          line-height: 1.7;
        }

        .info i {
          color: #0d6efd;
          width: 18px;
          margin-right: 4px;
        }

        .description {
          font-style: italic;
          color: #5a6b7c;
          margin-top: 14px;
          font-size: 14px;
          line-height: 1.5;
          border-top: 1px dashed #e0e7f1;
          padding-top: 10px;
        }

        .no-results {
          grid-column: 1 / -1;
          text-align: center;
          color: #999;
          font-style: italic;
          padding: 40px;
          font-size: 17px;
          background: #f8f9fd;
          border-radius: 12px;
          border: 1px dashed #b8daff;
        }

        .loading {
          grid-column: 1 / -1;
          text-align: center;
          padding: 30px;
          font-size: 18px;
          color: #666;
        }

        .banner {
          width: 100%;
          height: 220px; /* å¯æ ¹æ®éœ€è¦è°ƒæ•´é«˜åº¦ */
          background-image: url('./banner.png');
          background-size: cover;
          background-position: center;
          background-repeat: no-repeat;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
          border-bottom: 1px solid #e0e8f3;
        }

        .banner {
          position: relative;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
          font-size: 32px;
          font-weight: bold;
        }

        .banner::before {
          content: '';
          position: absolute;
          top: 0; left: 0; right: 0; bottom: 0;
          background: rgba(0, 0, 0, 0.2); /* æ·±è‰²é®ç½©ï¼Œæå‡æ–‡å­—å¯è¯»æ€§ */
          z-index: 1;
        }

        .banner > span {
          position: relative;
          z-index: 2;
        }
    </style>
</head>
<body>
<div id="app">
    <!-- æ¨ªå¹… Banner -->
    <div class="banner">
        <span>æ¬¢è¿ä½¿ç”¨æ™ºèƒ½æˆ¿äº§æœç´¢</span>
    </div>

    <!-- ä¸»å®¹å™¨ -->
    <div class="container">
<!--        <h1><i class="fas fa-home" style="color:#0d6efd;margin-right:8px;"></i>æˆ¿äº§æœç´¢</h1>-->

        <!-- æœç´¢æ¡†ï¼šè¾“å…¥å³æœç´¢ -->
        <input
                type="text"
                v-model="searchQuery"
                placeholder="ğŸ” è¾“å…¥éœ€æ±‚ï¼Œå¦‚ï¼šæ‰¾ä¸€ä¸ªæ­¦ä¾¯åŒºçš„ä¸‰æˆ¿ä¸¤å«ï¼Œæ€»ä»·100ä¸‡ï¼Œé è¿‘åœ°é“"
                class="search-box"
        />

        <!-- ç»“æœåŒºåŸŸ -->
        <div class="results-grid">
            <!-- åŠ è½½ä¸­ -->
            <div v-if="loading" class="loading">
                <i class="fas fa-spinner fa-spin"></i> æ­£åœ¨æœç´¢æˆ¿æº...
            </div>

            <!-- æ— ç»“æœ -->
            <div v-else-if="houses.length === 0" class="no-results">
                <i class="fas fa-search-minus" style="font-size:24px;margin-bottom:8px;color:#999;"></i><br>
                æš‚æ— åŒ¹é…çš„æˆ¿æºï¼Œè¯·å°è¯•å…¶ä»–å…³é”®è¯
            </div>

            <!-- æˆ¿æºåˆ—è¡¨ -->
            <div v-for="house in houses" :key="house.id" class="house-card">
                <div class="address">
                    {{ house.province }} {{ house.city }} {{ house.district }}
                </div>
                <div class="price">Â¥{{ house.price.toLocaleString() }} ä¸‡</div>
                <div class="info">
                    <i class="fas fa-bed"></i> {{ house.bedrooms }}å®¤{{ house.bathrooms }}å«<br>
                    <i class="fas fa-ruler-combined"></i> é¢ç§¯: {{ house.area }}ã¡<br>
                    <i class="fas fa-calendar-alt"></i> å»ºç­‘å¹´ä»£: {{ house.build_year }}å¹´<br>
                    <i class="fas fa-paint-brush"></i> è£…ä¿®: {{ house.decoration }}<br>
                    <i class="fas fa-subway"></i> è·åœ°é“: {{ Math.round(house.distance_to_metro) }}ç±³<br>
                    <i class="fas fa-school"></i> è·å­¦æ ¡: {{ Math.round(house.distance_to_school) }}ç±³
                </div>
                <div class="description">{{ house.description }}</div>
            </div>
        </div>
    </div>
</div>

<script>
    const { createApp, ref, watch } = Vue;

    createApp({
      setup() {
        const searchQuery = ref('æ‰¾ä¸€ä¸ªæ­¦ä¾¯åŒºçš„ä¸‰æˆ¿ä¸¤å«ï¼Œæ€»ä»·100ä¸‡ï¼Œé è¿‘åœ°é“');
        const houses = ref([]);
        const loading = ref(false);
        let debounceTimer = null;

        // æœç´¢å‡½æ•°ï¼šå‘é€è¯·æ±‚
        const searchHouses = async (query) => {
          if (!query.trim()) {
            houses.value = [];
            return;
          }

          loading.value = true;
          try {
            const response = await fetch('http://localhost:8010/search', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify({ query })
            });

            if (!response.ok) throw new Error('ç½‘ç»œé”™è¯¯');

            const data = await response.json();
            houses.value = Array.isArray(data.results) ? data.results : [];
          } catch (err) {
            console.error('æœç´¢å¤±è´¥:', err);
            houses.value = [];
            alert('æœç´¢å¤±è´¥ï¼Œè¯·æ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œï¼ˆhttp://localhost:8010/searchï¼‰');
          } finally {
            loading.value = false;
          }
        };

        // ç›‘å¬ searchQuery å˜åŒ–ï¼Œä½¿ç”¨é˜²æŠ–
        watch(searchQuery, (newQuery) => {
          // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
          if (debounceTimer) clearTimeout(debounceTimer);

          // è®¾ç½®æ–°çš„å»¶è¿Ÿè¯·æ±‚
          debounceTimer = setTimeout(() => {
            searchHouses(newQuery);
          }, 1000); // å»¶è¿Ÿ 600msï¼Œç¡®ä¿è¾“å…¥æš‚åœåå†è¯·æ±‚
        });

        return {
          searchQuery,
          houses,
          loading
        };
      }
    }).mount('#app');
</script>
</body>
</html>